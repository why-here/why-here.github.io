### 链接

链接可以执行于：编译时，加载时和运行时。

C/C++ 程序编译分为四步：

- 预处理：main.c 变为 main.i；翻译为 ASCII 码的中间文件。
- 编译：main.i 变为 main.s；翻译为 ASCII 码的汇编语言文件。
- 汇编：main.s 变为 main.o；翻译为一个可重定位目标文件。
- 链接：main.o 变为 main or a.out；翻译为一个可执行目标文件。

#### 静态链接

> 静态连接器以一组可重定位目标文件和命令行参数作为输入，生成一个可以加载运行的可执行目标文件。链接器必须完成两个任务：
>
> - 符号解析。符号指一个函数，全局/静态变量；符号解析的目的是将每个符号引用正好和一个符号定义关联起来。
> - 重定位。链接器通过把符号定义与一个内存位置关联起来，然后修改所有对这些符号的引用。

##### 目标文件

>  目标文件有三种形式：
>
> - 可重定位目标文件。
> - 可执行目标文件。
> - 共享目标文件。
>
> Linux 和 Unix 系统使用*可执行可链接格式*（ELF）

ELF 文件包含以下几部分：

- ELF 头
- .text，机器代码
- .rodata，只读数据
- .data，初始化为非 0 的全局/静态变量
- .bss，未初始化或初始化为 0 的全局/静态变量，在目标文件中不占用空间，仅仅是占位符。运行时，在内存中分配这些变量。
- .symtab，符号表，存放程序中定义和引用的函数和全局变量的信息
- .rel.text，需要重定位的代码的列表，如调用另外一个目标文件的代码
- .rel.data，需要重定位的数据的列表，如引用另外一个目标文件的全局变量
- .debug，调试符号表，需要 -g 选项
- .line，行号和机器指令的映射，需要 -g 选项
- .strtab，字符串表，存储各个符号的名字
- 节头部表，存储节的位置和大小

BSS 叫 “块存储开始（Block Storage Start）”，也可以看成（Better Save Space）

##### 